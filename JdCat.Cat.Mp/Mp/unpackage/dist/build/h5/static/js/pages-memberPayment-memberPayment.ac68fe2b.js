(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-memberPayment-memberPayment"],{"0417":function(e,t,a){var n=a("508e");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("55a21492",n,!0,{sourceMap:!1,shadowMode:!1})},2435:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(a("a34a")),i=o(a("f483")),r=o(a("4964"));function o(e){return e&&e.__esModule?e:{default:e}}function c(e,t,a,n,i,r,o){try{var c=e[r](o),d=c.value}catch(s){return void a(s)}c.done?t(d):Promise.resolve(d).then(n,i)}function d(e){return function(){var t=this,a=arguments;return new Promise(function(n,i){var r=e.apply(t,a);function o(e){c(r,n,i,o,d,"next",e)}function d(e){c(r,n,i,o,d,"throw",e)}o(void 0)})}}var s=Date.now(),u={data:function(){return{cardId:void 0,openid:void 0,encrypt_code:void 0,member:{},barcode:void 0,qrcode:void 0,payCode:void 0}},onLoad:function(){var e=d(n.default.mark(function e(t){return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.cardId=t.card_id,this.openid=t.openid,this.encrypt_code=t.encrypt_code,e.next=5,this.getMember(t);case 5:this.member=e.sent,this.loadCode(),this.refreshTime=setInterval(function(){var e=Date.now();e-s>6e4&&this.loadCode()}.bind(this),5e3),this.payTime=setInterval(function(){this.payResult()}.bind(this),3e3);case 9:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),onUnload:function(){clearInterval(this.refreshTime),clearInterval(this.payTime)},computed:{balance:function(){return this.member.balance/100}},methods:{getMember:function(){var e=d(n.default.mark(function e(t){var a,r;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a=getApp().globalData.member,!a){e.next=3;break}return e.abrupt("return",JSON.parse(JSON.stringify(a)));case 3:return r=new Promise(function(e,a){i.default.request({url:"/card/member?cardId=".concat(t.card_id,"&openId=").concat(t.openid),success:function(t){e(t)},fail:function(e){a(e)}})}),e.next=6,r;case 6:return a=e.sent.data,getApp().globalData.member=JSON.parse(JSON.stringify(a)),e.abrupt("return",a);case 9:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),loadCode:function(){var e=this;i.default.request({url:"/card/paycode?id="+e.member.id,success:function(t){e.payCode=t.data.data,s=Date.now(),e.barcode="".concat(r.default.apiUrl,"/card/barcode?code=").concat(e.payCode,"&t=").concat(s),e.qrcode="".concat(r.default.apiUrl,"/card/qrcode?code=").concat(e.payCode,"&t=").concat(s)}})},charge:function(){uni.redirectTo({url:"/pages/memberCharge/memberCharge?card_id=".concat(this.cardId,"&encrypt_code=").concat(this.encrypt_code,"&openid=").concat(this.openid)})},payResult:function(){var e=this;i.default.request({url:"/card/payResult?code="+this.payCode,success:function(t){0!==t.data.status&&uni.redirectTo({url:"/pages/memberPaySuccess/memberPaySuccess?card_id=".concat(e.cardId,"&encrypt_code=").concat(e.encrypt_code,"&openid=").concat(e.openid)})}})}}};t.default=u},"3cb7":function(e,t,a){"use strict";var n=a("0417"),i=a.n(n);i.a},4964:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n="http://mpapi.whliupangzi.cn/api",i="",r={apiUrl:n,openid:i};t.default=r},"508e":function(e,t,a){t=e.exports=a("2350")(!1),t.push([e.i,'uni-page-body[data-v-198d2794]{height:100%;background-color:#d0a762}.title[data-v-198d2794]{margin-top:%?20?%;text-align:center;font-size:120%;font-weight:700;color:#fff}.sub-title[data-v-198d2794]{margin-top:%?10?%;text-align:center;font-size:80%;color:#fff}.code[data-v-198d2794]{width:86%;margin-top:%?20?%;background-color:#fff;border-radius:%?20?%}.barcode[data-v-198d2794]{margin-top:%?40?%;text-align:center}.code-self[data-v-198d2794]{text-align:center;font-size:.9em}.qrcode[data-v-198d2794]{text-align:center}.tip[data-v-198d2794]{text-align:center}.divide[data-v-198d2794]{position:relative;border-top:1px dashed #d4d4d4}.divide[data-v-198d2794]:before{content:"";position:absolute;width:8px;height:8px;background:#d0a762;border-radius:50%;top:-4px;left:-4px}.divide[data-v-198d2794]:after{content:"";position:absolute;width:8px;height:8px;background:#d0a762;border-radius:50%;top:-4px;right:-4px}.balance[data-v-198d2794]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;margin:%?30?%;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between}.balance-text[data-v-198d2794]{color:#d8af5e;margin-left:%?30?%}.balance-charge[data-v-198d2794]{text-align:right;margin-right:%?30?%;background:#ee903c;color:#fff}',""])},9342:function(e,t,a){"use strict";a.r(t);var n=a("ffe1"),i=a("d6ee");for(var r in i)"default"!==r&&function(e){a.d(t,e,function(){return i[e]})}(r);a("3cb7");var o=a("2877"),c=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"198d2794",null);t["default"]=c.exports},a34a:function(e,t,a){e.exports=a("bbdd")},bbdd:function(e,t,a){var n=function(){return this||"object"===typeof self&&self}()||Function("return this")(),i=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,r=i&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,e.exports=a("96cf"),i)n.regeneratorRuntime=r;else try{delete n.regeneratorRuntime}catch(o){n.regeneratorRuntime=void 0}},d6ee:function(e,t,a){"use strict";a.r(t);var n=a("2435"),i=a.n(n);for(var r in n)"default"!==r&&function(e){a.d(t,e,function(){return n[e]})}(r);t["default"]=i.a},f483:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a("4964"));function i(e){return e&&e.__esModule?e:{default:e}}var r=function(e){return e.url=n.default.apiUrl+e.url,e.fail||(e.fail=function(e){uni.showToast({title:"网络请求错误",icon:"none"})}),uni.request(e)},o=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return a.forEach(function(t){for(var a in t)e[a]=t[a]}),e},c=function(e){return e.slice(0,1).toUpperCase()+e.slice(1)},d={request:r,extend:o,firstLetterUpper:c};t.default=d},ffe1:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"container"},[a("v-uni-text",{staticClass:"title"},[e._v("付款码")]),a("v-uni-text",{staticClass:"sub-title"},[e._v("结账时出示会员卡")]),a("v-uni-view",{staticClass:"code"},[a("v-uni-view",{staticClass:"barcode"},[a("v-uni-image",{staticStyle:{height:"142upx",width:"600upx"},attrs:{mode:"aspectFit",src:e.barcode}})],1),a("v-uni-view",{staticClass:"code-self"},[a("v-uni-text",[e._v(e._s(e.payCode))])],1),a("v-uni-view",{staticClass:"qrcode"},[a("v-uni-image",{staticStyle:{height:"231px",width:"231px"},attrs:{mode:"aspectFit",src:e.qrcode}})],1),a("v-uni-view",{staticClass:"tip"},[a("v-uni-text",{staticClass:"jdcat jdcat-jinggao",staticStyle:{"font-size":"12px",color:"gray"}},[e._v("本支付码定时更新，请勿截屏，以免影响正常使用")])],1),a("v-uni-view",{staticClass:"divide"}),a("v-uni-view",{staticClass:"balance"},[a("v-uni-view",{staticClass:"balance-text"},[a("v-uni-view",{staticClass:"jdcat jdcat-money-circle",staticStyle:{"font-size":"80%","white-space":"pre"}},[a("v-uni-text",{staticStyle:{"margin-left":"5px"}},[e._v("余额")])],1),a("v-uni-view",{staticClass:"jdcat jdcat-money-rmb",staticStyle:{"font-size":"110%"}},[e._v(e._s(e.balance))])],1),a("v-uni-button",{staticClass:"balance-charge",on:{click:function(t){t=e.$handleEvent(t),e.charge()}}},[e._v("充值")])],1)],1)],1)},i=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return i})}}]);