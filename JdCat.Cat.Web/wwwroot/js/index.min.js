(function(n){"use strict";var t={initFunction:function(){t.$menu=n("#main-menu");t.$menu.metisMenu();t.$menu.on("click","a",function(){var i=n(this);i.siblings()[0]||(t.$menu.find("a.active-menu").removeClass("active-menu"),i.addClass("active-menu"))});n(window).bind("load resize",function(){n(this).width()<768?n("div.sidebar-collapse").addClass("collapse"):n("div.sidebar-collapse").removeClass("collapse")})},initialization:function(){t.initFunction()}},i,o;n(document).ready(function(){t.initFunction();n("#sideNav").click(function(){n(this).hasClass("closed")?(n(".navbar-side").animate({left:"0px"}),n(this).removeClass("closed"),n("#page-wrapper").animate({"margin-left":"260px"})):(n(this).addClass("closed"),n(".navbar-side").animate({left:"-260px"}),n("#page-wrapper").animate({"margin-left":"0px"}))})});i={$frame:n("#mainframe"),defaultUrl:"/product",method:{hashchange:function(){var n=i.defaultUrl;window.location.href.indexOf("#")>-1&&(n=window.location.href.substring(window.location.href.indexOf("#")+1)||"/home/empty");i.$frame.attr("src",n)}}};window.onhashchange=function(){i.method.hashchange()};i.method.hashchange();var e=new WebSocket(pageData.orderUrl+"?id="+pageData.business.id),r=document.getElementById("newOrder"),u=document.getElementById("autoOrder"),f=document.getElementById("exceptionOrder");e.onmessage=function(t){var i=new Date,e=t.data;axios.get("/order/MessageHandler?code="+e).then(function(n){n.data.data===1?r.play():n.data.data===2?u.play():n.data.data===3&&f.play();o.list.push({code:e,time:i.getHours()+":"+i.getMinutes(),tip:n.data.success})}).catch(function(t){n.alert(t)})};e.onopen=function(n){console.log("服务已连接",n)};e.onclose=function(t){n.primary(t.reason||"新订单提醒异常，请刷新后重试")};o=new Vue({el:"#msg",data:{list:[]},components:{"cat-order-msg":{data:function(){return{}},methods:{navigate:function(){o.list.remove(this.msg)}},props:["msg"],template:`
                        <li>
                            <a :href="'#/Order?code=' + msg.code" @click="navigate()">
                                <div :class="msg.tip ? '' : 'text-danger'">
                                    <i class="fa" :class="msg.tip ? 'fa-info-circle fa-fw text-primary' : 'fa-warning text-danger'"></i> {{msg.tip ? '您有一个新订单' : '异常订单'}}
                                    <span class="pull-right text-muted small">{{msg.time}}</span>
                                </div>
                            </a>
                        </li>`}}});n("body").one("click",function(){r.play();u.play();f.play();setTimeout(function(){r.pause();r.currentTime=0;u.pause();u.currentTime=0;f.pause();f.currentTime=0},20)})})(jQuery);