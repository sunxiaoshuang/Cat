(function(){var n=new Vue({el:"#app",data:{storeTree:[],typeTree:[]},computed:{checkedStores:function(){var n=[];return this.storeTree.forEach(function(t){t.list.forEach(function(t){t.list.forEach(function(t){t.list.forEach(function(t){t.checked&&n.push(t)})})})}),n},checkedProducts:function(){var n=[];return this.typeTree.forEach(function(t){t.list.forEach(function(t){t.checked&&n.push(t)})}),n}},methods:{expand:function(n){n.expanded=!n.expanded},checkChange:function(){var n=function(t){t.list&&t.list.forEach(function(i){i.checked=t.checked;n(i)})},t=function(n){n.parent&&(n.parent.checked=!1,t(n.parent))};return function(i){n(i);i.checked||t(i)}}(),submit:function(){var t="",i="",r="确定复制吗？";if(n.checkedStores.length===0){$.alert("请勾选要复制商品的门店！");return}if(n.checkedProducts.length===0){$.alert("请勾选要复制的商品！");return}n.checkedStores.length<10&&(n.checkedStores.forEach(function(n){t+=n.name+"、"}),t=t.substring(0,t.length-1));n.checkedProducts.length<10&&(n.checkedProducts.forEach(function(n){i+=n.name+"、"}),i=i.substring(0,i.length-1));r="复制商品操作不可逆，且复制的商品属于无分类状态，需要用户登陆商户调整商品分类，确定向选择的商户复制商品吗？";$.primary(r,function(){$.loading();var t=n.checkedStores.map(function(n){return n.id}),i=n.checkedProducts.map(function(n){return n.id});axios.post("/Product/Copy",{storeIds:t,productIds:i}).then(function(t){if($.loaded(),!t.data.success){$.alert(t.data.msg);return}$.alert(`操作成功`,"success");n.typeTree.forEach(function(n){n.list.forEach(function(n){n.checked=!1})})}).catch(function(n){$.loaded();$.alert(n)})})},cancel:function(){}},created:function(){var n=this;axios.get("/Product/GetStoreTree").then(function(t){t.data.forEach(function(n){n.checked=!1;n.expanded=!1;n.list.forEach(function(t){t.checked=!1;t.expanded=!1;t.parent=n;t.list.forEach(function(n){n.checked=!1;n.expanded=!1;n.parent=t;n.list.forEach(function(t){t.checked=!1;t.expanded=!1;t.parent=n})})})});n.storeTree=t.data}).catch(function(n){$.alert(n)});axios.get("/Product/GetProductTree").then(function(t){t.data.forEach(function(n){n.checked=!1;n.expanded=!1;n.list.forEach(function(t){t.checked=!1;t.expanded=!1;t.parent=n})});n.typeTree=t.data}).catch(function(n){$.alert(n)})}})})();