(function(){new Vue({el:"#app",data:{card:{member_card:{base_info:{}},bonusSale:{amount:0,give:0,mode:0},bonusCharge:{amount:0,give:0,mode:1},bonusOpen:{amount:0,give:0,mode:2}},colors:[{name:"Color010",color:"#63b359",selected:!1},{name:"Color020",color:"#2c9f67",selected:!1},{name:"Color030",color:"#509fc9",selected:!1},{name:"Color040",color:"#5885cf",selected:!1},{name:"Color050",color:"#9062c0",selected:!1},{name:"Color060",color:"#d09a45",selected:!1},{name:"Color070",color:"#e4b138",selected:!1},{name:"Color080",color:"#ee903c",selected:!1},{name:"Color090",color:"#dd6549",selected:!1},{name:"Color100",color:"#cc463d",selected:!1}]},computed:{cardStatus:function(){return this.card.member_card.base_info.status?this.card.member_card.base_info.status==="CARD_STATUS_VERIFY_OK"?"可投放":"审核中":"未创建"}},methods:{selectColor:function(n){n.selected||(this.colors.forEach(n=>n.selected=!1),n.selected=!0,this.card.member_card.base_info.color=n.name)},setWhiteList:function(){axios.post("/Card/SetWhiteList")},save:function(){var n=this.card.member_card.base_info,i,t;if(!n.brand_name){$.alert("请输入品牌名称");return}if(!n.title){$.alert("请输入副标题");return}if(!n.notice){$.alert("请输入操作提示");return}if(!this.card.member_card.prerogative){$.alert("请输入特权说明");return}if(!n.description){$.alert("请输入使用须知");return}if(!n.service_phone){$.alert("请输入联系电话");return}$.loading();n.id?(i={card_id:n.id,member_card:{base_info:{title:n.title,color:n.color,notice:n.notice,service_phone:n.service_phone,description:n.description},prerogative:this.card.member_card.prerogative},chargeList:this.card.chargeList,bonusSale:this.card.bonusSale,bonusCharge:this.card.bonusCharge,bonusOpen:this.card.bonusOpen},axios.post("/Card/UpdateCard",i).then(function(n){if($.loaded(),n.data.success){window.location.reload();return}$.alert(n.data.msg)}).catch(function(n){$.loaded();$.alert(n)})):(t={card:this.card},t.card.member_card.bonus_rule.init_increase_bonus=this.card.bonusOpen.give,axios.post("/Card/CreateMemberCard",t).then(function(n){if($.loaded(),n.data.success){window.location.reload();return}$.alert(n.data.msg)}).catch(function(n){$.loaded();$.alert(n)}))},qrcode:function(){window.open("/Card/CreateMemberQrcode?cardId="+this.card.member_card.base_info.id)},addCharge:function(){this.card.chargeList.length>=4||this.card.chargeList.push({amount:0,give:0})},reduceCharge:function(n){this.card.chargeList.splice(n,1)}},created:function(){var n=this;$.loading();axios.all([axios.get("/Card/GetMemberCard"),axios.get("/Card/GetCardRule")]).then(function(t){var i,r;$.loaded();i=t[0].data.errcode===0?t[0].data.card:{card_type:"MEMBER_CARD",member_card:{base_info:{brand_name:"",title:"",code_type:"CODE_TYPE_BARCODE",can_give_friend:!1,center_title:"会员支付",center_sub_title:"点击生成二维码",center_url:mpUrl+"/member.html?sign=pay",color:"#63b359",custom_url:mpUrl+"/member.html?sign=charge",custom_url_name:"会员充值",custom_url_sub_title:"",date_info:{type:"DATE_TYPE_PERMANENT"},description:"会员卡优惠不可与其他优惠同享",get_limit:1,location_id_list:[],logo_url:"",notice:"使用时向服务员出示此券",promotion_url:mpUrl+"/member.html?sign=sale",promotion_url_name:"消费记录",service_phone:"",sku:{quantity:1e8},use_custom_code:!1},advanced_info:{},auto_activate:!1,bonus_cleared:"",bonus_rules:"",bonus_rule:{},prerogative:"",supply_balance:!1,balance_url:mpUrl+"/member.html?sign=charge",supply_bonus:!1,wx_activate:!0}};i.chargeList=t[1].data.charge.length===0?[{amount:0,give:0}]:t[1].data.charge;i.bonusSale=t[1].data.bonus.first(n=>n.mode===0)||{amount:0,give:0,mode:0};i.bonusCharge=t[1].data.bonus.first(n=>n.mode===1)||{amount:0,give:0,mode:1};i.bonusOpen=t[1].data.bonus.first(n=>n.mode===2)||{amount:0,give:0,mode:2};n.card=i;r=n.colors.first(t=>t.color===n.card.member_card.base_info.color);r&&(n.card.member_card.base_info.color=r.name,r.selected=!0)})}})})();