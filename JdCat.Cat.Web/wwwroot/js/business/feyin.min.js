(function(n){var t,i=new Vue({el:"#app",data:{showError:!1,modifyState:!1,entity:pageObj.business,list:pageObj.printers},methods:{printerType:function(n){return n.type==0?"佳博":n.type==1?"易联云":n.type==2?"飞鹅":"外卖管家"},modify:function(){this.modifyState=!0},save:function(){var t=this;if(!this.entity.feyinApiKey||!this.entity.feyinMemberCode){n.alert("请将开发设置信息输入完整");this.showError=!0;return}this.showError=!1;axios.get(`/business/savefeyin?feyinApiKey=${this.entity.feyinApiKey}&feyinMemberCode=${this.entity.feyinMemberCode}`).then(function(i){i.data.success?(n.alert(i.data.msg,"success"),t.modifyState=!1):n.alert(i.data.msg)}).catch(function(t){n.alert(t)})},cancel:function(){this.modifyState=!1},addBind:function(){n.view({title:"打印机信息",footDisplay:!0,template:`
                        <div class='row form-horizontal' id='bindView'>
                            <label class='col-md-3 col-xs-12 control-label'>打印机名称：</label>
                            <div class='col-md-8 col-xs-12' style='margin-bottom: 10px;'>
                                <input type='text' class='form-control' v-model.trim='name' />
                            </div>
                            <label class='col-md-3 col-xs-12 control-label'>打印机编号：</label>
                            <div class='col-md-8 col-xs-12' style='margin-bottom: 10px;'>
                                <input type='text' class='form-control' v-model.trim='code' />
                            </div>
                            <label class='col-md-3 col-xs-12 control-label'>打印机密钥：</label>
                            <div class='col-md-8 col-xs-12' style='margin-bottom: 10px;'>
                                <input type='text' class='form-control' v-model.trim='apiKey' />
                            </div>
                            <label class='col-md-3 col-xs-12 control-label'>打印机类别：</label>
                            <div class='col-md-8 col-xs-12' style='margin-bottom: 10px;'>
                                <select class='form-control' v-model='type'>
                                    <option value='0'>佳博</option>
                                    <option value='1'>易联云</option>
                                    <option value='2'>飞鹅</option>
                                    <option value='3'>外卖管家</option>
                                </select>
                            </div>
                            <label class='col-md-3 col-xs-12 control-label'>流量卡号（仅限飞鹅）：</label>
                            <div class='col-md-8 col-xs-12'>
                                <input type='text' class='form-control' v-model.trim='remark' />
                            </div>
                        </div>`,load:function(){t=new Vue({el:"#bindView",data:{code:"",name:"",type:"1",apiKey:""}});this.on("hidden.bs.modal",function(){t&&(t.$destroy(),t=null)})},submit:function(){var u=t.code,f=t.name,r=t.type,e=t.apiKey,o=t.remark;return f?u?r==1&&!e?(n.alert("易联云打印机需要填写打印机密钥"),!1):r==2&&!o?(n.alert("飞鹅打印机请在备注栏输入流量卡号码"),!1):(axios.get(`/business/addbind?code=${u}&name=${f}&type=${r}&apiKey=${e}&remark=${o}`).then(function(t){t.data.success?(n.alert(t.data.msg,"success"),i.list.push(t.data.data)):n.alert(t.data.msg)}).catch(function(t){n.alert(t)}),!0):(n.alert("请输入打印机编号"),!1):(n.alert("请输入打印机名称"),!1)}})},unbind:function(t){var i=this;n.primary("解除绑定后，打印机将不可打印小票，确定解除吗？",function(){return axios.get("/business/unbind/"+t.id).then(function(r){r.data.success?(n.alert(r.data.msg,"success"),i.list.remove(t)):n.alert(r.data.msg)}).catch(function(t){n.alert(t)}),!0})},printerDefault:function(t){if(!t.isDefault){var i=this;axios.get("/business/setDefaultPrinter/"+t.id).then(function(r){r.data.success?(n.alert(r.data.msg,"success"),i.list.forEach(function(n){n.isDefault=!1}),t.isDefault=!0):n.alert(r.data.msg)}).catch(function(t){n.alert(t)})}}}})})(jQuery);