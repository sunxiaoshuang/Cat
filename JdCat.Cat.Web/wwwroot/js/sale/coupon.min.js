(function(){pageData.entity&&!!pageData.entity.startDate&&(pageData.entity.startDate=pageData.entity.startDate.substring(0,10),pageData.entity.endDate=pageData.entity.endDate.substring(0,10));var n=new Vue({el:"#app",data:{timeType:pageData.entity?pageData.entity.validDay>0?0:1:0,quantityType:pageData.entity?pageData.entity.quantity<0?0:1:0,minConsumeType:pageData.entity?pageData.entity.minConsume<0?0:1:0,showError:!1,entity:pageData.entity||{name:"",value:1,quantity:-1,minConsume:-1,startDate:null,endDate:null,validDay:30},btnDisplay:!1,isCheck:!!pageData.entity},methods:{create:function(){var t=this.entity,n=this;if(!t.name){$.alert("请输入优惠券名称");n.showError=!0;return}if(this.timeType==0&&t.validDay<=0){$.alert("请正确输入有效天数");n.showError=!0;return}if(this.timeType==1){if(!t.startDate||!t.endDate){$.alert("请选择优惠券有效期时间");n.showError=!0;return}if(t.startDate>t.endDate){$.alert("请正确选择优惠券有效期时间");n.showError=!0;return}}if(t.value<=0){$.alert("券面金额必须大于零");n.showError=!0;return}if(this.quantityType==1&&t.quantity<=0){$.alert("发放数量必须大于零");n.showError=!0;return}if(this.minConsumeType==1&&t.minConsume<=0){$.alert("最低消费必须大于零");n.showError=!0;return}n.showError=!1;n.btnDisplay=!0;$.loading();axios.post("/Sale/CreateCoupon",t).then(function(t){if($.loaded(),!t.data.success){$.alert(t.data.msg);n.btnDisplay=!1;return}$.alert(t.data.msg,"success");setTimeout(function(){window.location="/Sale/CouponList"},2e3)}).catch(function(t){$.loaded();$.alert(t);n.btnDisplay=!1})},ret:function(){history.go(-1)}},watch:{quantityType:function(){if(this.quantityType==0){this.entity.quantity=-1;return}this.entity.quantity=1e3},minConsumeType:function(){if(this.minConsumeType==0){this.entity.minConsume=-1;return}this.entity.minConsume=1},timeType:function(){this.timeType==0?(this.entity.startDate=null,this.entity.endDate=null,this.entity.validDay=30):this.entity.validDay=-1}}}),t={format:"yyyy-mm-dd",autoclose:!0,maxView:1,minView:2,todayBtn:!0,todayHighlight:!0,language:"zh-CN"};$("#txtStartDate").datetimepicker(t).on("changeDate",function(){n.entity.startDate=this.value});$("#txtEndDate").datetimepicker(t).on("changeDate",function(){n.entity.endDate=this.value})})();