(function(){function s(){axios.get("/Dianwoda/Info").then(function(t){$("#info").html(t.data);e=new Vue({el:"#infoPage",data:{isCreated:!!pageObj.dwd.shop_title,shop:pageObj.dwd,balance:pageObj.balance},methods:{create:function(){if(this.balance>0){$.alert("账户余额大于0，不可以重新创建。");return}u()},recharge:function(){$.view({name:"recharge",title:"商户充值",footDisplay:"block",template:`
                                    <div class="row form-horizontal" id="recharge-container">
                                        <div class="form-group">
                                            <label class="control-label col-xs-3">
                                                <span class="require">充值金额：</span>
                                            </label>
                                            <div class="col-xs-8">
                                                <input class="form-control" v-model="amount" type="number" />
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label col-xs-3">
                                                <span class="require">充值方式：</span>
                                            </label>
                                            <div class="col-xs-9">
                                                <div class="kui-checkbox checkbox pull-left m-left-md m-right-md margin-right-20">
                                                    <label class="label-checkbox">
                                                        <input type="radio" name="serviceProvider" value="0" v-model="mode">
                                                        <span class="custom-checkbox"></span>
                                                        支付宝
                                                    </label>
                                                </div>
                                                <div class="kui-checkbox checkbox pull-left m-left-md m-right-md margin-right-20">
                                                    <label class="label-checkbox">
                                                        <input type="radio" name="serviceProvider" value="1" v-model="mode">
                                                        <span class="custom-checkbox"></span>
                                                        微信
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>`,load:function(){n=new Vue({el:"#recharge-container",data:{amount:0,mode:0}});f.call(this,n)},submit:function(){if(n.amount==0){$.alert("请输入充值金额");return}var t=n.mode==0?"Alipay":"Wechat";return window.open(`/Dianwoda/RechargePage?type=${t}&amount=${n.amount}`),$.primary("充值完成后，点击确定刷新本页面",function(){location.reload()}),!0}})}}})})}function h(){axios.get("/Dianwoda/Detail").then(function(n){var i=$("#detail");i.html(n.data);t=new Vue({el:"#detailPage",data:{startDate:i.find("#txtStartDate").val(),endDate:i.find("#txtEndDate").val(),pageCount:0,pageIndex:1,list:null},methods:{loadData:function(){var n=this;axios.get(`/Dianwoda/DetailList?pageIndex=${this.pageIndex}&startDate=${this.startDate}&endDate=${this.endDate}`).then(function(t){n.list=t.data.result.detail;n.pageCount=t.data.result.page_count;console.log(n)}).catch(function(n){$.alert(n)})},search:function(){this.loadData()},prev:function(){this.pageIndex--;this.loadData()},page:function(n){this.pageIndex=n;this.loadData()},next:function(){this.pageIndex++;this.loadData()}},created:function(){this.loadData()}});i.find("#txtStartDate").datetimepicker($.dateOptions).on("changeDate",function(){t.startDate=this.value});i.find("#txtEndDate").datetimepicker($.dateOptions).on("changeDate",function(){t.endDate=this.value})})}function c(){}function u(){$.view({name:"add",title:"创建商户",footDisplay:"block",url:"/Dianwoda/Create",saveText:"创建商户",load:function(){i=new Vue({el:"#createPage",data:{cityList:r,obj:createPageObj},methods:{change:function(n){n.target.selectedOptions[0]&&(this.obj.city_name=n.target.selectedOptions[0].text)}}});f.call(this,i)},submit:function(){var n=i.obj;return!n.city_code||!n.shop_title||!n.mobile||!n.lng||!n.lat||!n.addr?($.alert("请将商户信息输入完整"),!1):(n.lng=n.lng,n.lat=n.lat,axios.post("/Dianwoda/Create",n).then(function(n){if(!n.data.success){$.alert(n.data.msg);return}location.reload()}).catch(function(n){$.alert(n)}),!0)}})}function f(n){this.on("hidden.bs.modal",function(){n&&(n.$destroy(),n=null)})}var e,i,t,o,r,n;if(axios.get("/data/dianwoda.json").then(function(n){r=n.data}),$("#btnCreate").click(function(){u()}),pageObj.exist){$('a[data-toggle="tab"]').on("show.bs.tab",function(n){var i=$(n.target).text();i=="商户信息"||(i=="交易明细"?t||h():i=="账单"&&(o||c()))});s()}})();