(function(){function u(n){this.on("hidden.bs.modal",function(){n&&(n.$destroy(),n=null)})}var i=`
        <div class="row form-horizontal" id="add-menu">
            <div class="form-group">
                <label class="control-label col-xs-3">
                    菜单类型：
                </label>
                <div class="col-xs-8">
                    <select class="form-control" v-model="menu.type">
                        <option v-for="item in types" :value="item.value">{{item.name}}</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-xs-3">
                    <span class="require">菜单标题：</span>
                </label>
                <div class="col-xs-8">
                    <input type="text" class="form-control" v-model="menu.name" />
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-xs-3">
                    KEY值：
                </label>
                <div class="col-xs-8">
                    <input type="text" class="form-control" v-model="menu.key" />
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-xs-3">
                    URL：
                </label>
                <div class="col-xs-8">
                    <input type="text" class="form-control" v-model="menu.url" />
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-xs-3">
                    小程序AppID：
                </label>
                <div class="col-xs-8">
                    <input type="text" class="form-control" v-model="menu.appid" />
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-xs-3">
                    小程序路径：
                </label>
                <div class="col-xs-8">
                    <input type="text" class="form-control" v-model="menu.pagepath" />
                </div>
            </div>
        </div>
    `,t=[{name:"",value:0},{name:"点击类型",value:1},{name:"网页类型",value:2},{name:"小程序类型",value:3}],r={click:1,view:2,miniprogram:3},n=new Vue({el:"#app",data:{tree:[],selectItem:{},menu:{},types:JSON.parse(JSON.stringify(t))},methods:{open:function(n){var t=!n.checked;this.tree.forEach(function(n){n.checked=!1});n.checked=t;this.menu=t?n:{}},choice:function(n,t){t.sub_button.forEach(n=>n.checked=!1);t.checked=!1;n.checked=!0;this.menu=n},save:function(){axios.post("/weixin/createAppMenu",this.tree).then(function(){$.alert("保存成功","success")}).catch(function(n){$.alert(n)})},remove:function(){$.confirm("提示","公众号菜单将被清空，确定删除吗？",function(){return axios.post("/weixin/createAppMenu",{}).then(function(){$.alert("删除成功","success");n.tree=[]}).catch(function(n){$.alert(n)}),!0})},add:function(){var r;$.view({title:"添加菜单",template:i,footDisplay:"block",load:function(){r=new Vue({el:"#add-menu",data:{menu:{type:"",name:"",key:"",url:"",appid:"",pagepath:"",checked:!1,sub_button:[]},types:JSON.parse(JSON.stringify(t))}});u.call(this,r)},submit:function(){var t=JSON.parse(JSON.stringify(r.menu)),i=n.tree.first(function(n){return n.checked});return i?i.sub_button.push(t):n.tree.push(t),!0}})}},created:function(){var n=this;axios.get("/weixin/getAppMenu").then(function(t){var i=JSON.parse(t.data);i.menu&&(n.tree=i.menu.button.map(function(n){return n.checked=!1,n.type=r[n.type],n}))}).catch(function(n){$.alert(n.response.data.message||n)})}})})();