(function(n){function f(n){return n.map(function(n){n.expend=!1}),n}var t=["外卖","堂食"],i=["","线上支付"],r=["第三方平台","自己配送","自提"],u={"1":"已付款","2":"已拒单","4":"待配送","8":"待配送","16":"配送中","32":"配送异常","64":"已送达","128":"用户已确认收货","256":"未付款","512":"已评价","1024":"已关闭"};new Vue({el:"#app",data:{buttons:[{name:"全部订单",type:0,selected:!0},{name:"待付款",type:256,selected:!1},{name:"待接单",type:1,selected:!1},{name:"已接单",type:4,selected:!1},{name:"待配送",type:8,selected:!1},{name:"配送中",type:16,selected:!1},{name:"待确认",type:64,selected:!1},{name:"已关闭",type:1024,selected:!1},{name:"已完成",type:128,selected:!1},],orderList:[{id:0,orderCode:"85412654545812",createTime:"2018-12-31 11:34:27",category:0,paymentType:1,status:1,price:552.65,receiverAddress:"湖北省武汉市武汉经济技术开发区神龙大道69号",receiverName:"张三",phone:"17355698852",expend:!1},{id:1,orderCode:"80012015204551",createTime:"2018-05-22 06:11:00",category:0,paymentType:1,status:2,price:25633.65,expend:!1},{id:2,orderCode:"56333221478992",createTime:"2012-02-09 23:47:27",category:0,paymentType:1,status:4,price:7855200.65,expend:!1},],pageObj:{pageIndex:1,pageSize:20,pageCount:0,recordCount:0},curType:null},methods:{initPageObj:function(){this.pageObj.pageIndex=1;this.pageObj.pageSize=20;this.pageObj.pageCount=0;this.pageObj.recordCount=0},loadData:function(){var t=this;axios.post(`/order/getorder?status=${this.curType.type}`,this.pageObj).then(function(n){t.orderList=f(n.data.data.list);t.pageObj.recordCount=n.data.data.rows;t.pageObj.pageCount=Math.ceil(t.pageObj.recordCount/t.pageObj.pageSize)}).catch(function(t){n.loaded();n.alert(t)})},changeType:function(n){this.buttons.forEach(n=>{n.selected=!1});n.selected=!0;this.curType=n;this.initPageObj();this.loadData()},expend:function(n){n.expend=!n.expend},prevPage:function(){this.pageObj.pageIndex!==1&&(this.pageObj.pageIndex--,this.loadData())},changePage:function(n){this.pageObj.pageIndex!==n&&(this.pageObj.pageIndex=n,this.loadData())},nextPage:function(){this.pageObj.pageIndex!==this.pageObj.pageCount&&(this.pageObj.pageIndex=this.pageObj.pageIndex+1,this.loadData())},receive:function(t){axios.post("/order/receive/"+t.id).then(function(i){i.data.success?(n.alert(i.data.msg,"success"),t.status=4):n.alert(i.data.msg)}).catch(function(t){n.alert(t)})},reject:function(t){n.view({title:"原因",footDisplay:!0,template:`
                        <div class='row'>
                            <div class='col-xs-12'>请输入拒绝原因</div>
                            <div class='col-xs-12'>
                                <textarea class='form-control'></textarea>
                            </div>
                        </div>`,submit:function(i,r){var u=r.find("textarea").val();return u?(axios.post("/order/reject/"+t.id).then(function(t){t.data.success?n.alert(t.data.msg,"success"):n.alert(t.data.msg)}).catch(function(t){n.alert(t)}),!0):(n.alert("请输入拒绝原因"),!1)}})},thirdSend:function(){},selfSend:function(){}},filters:{category:function(n){return t[n]},paymentType:function(n){return i[n]},status:function(n){return u[n]},deliveryType:function(n){return r[n]}},created:function(){var n=this;this.curType=this.buttons[0];this.loadData()}})})(jQuery);