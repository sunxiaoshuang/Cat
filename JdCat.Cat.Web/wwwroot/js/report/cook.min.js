(function(){var t=jdCat.utilMethods.now(),n=new Vue({el:"#app",data:{items:[],products:null,type:0,start:t,end:t},methods:{search:function(){this.loadData()},catCook:function(n){if(!n.selected){var t=this;this.items.forEach(function(n){n.selected=!1});n.selected=!0;$.loading();axios.get(`/report/getSingleCookData/${n.id}?start=${this.start}&end=${this.end}&type=${this.type}`).then(function(n){$.loaded();t.products=n.data;i()}).catch(function(n){$.alert(n)})}},loadData:function(){var n=this;axios.get(`/report/getCookData?start=${this.start}&end=${this.end}&type=${this.type}`).then(function(t){n.items=t.data.map(function(n){return n.amount=parseFloat(n.amount.toFixed(2)),$.extend(n,{selected:!1})})}).catch(function(n){$.alert(n)})},exportData:function(){location=`/report/exportCookData?start=${this.start}&end=${this.end}&type=${this.type}`}},created:function(){this.loadData()}}),i=function(){var t={title:{text:"产品销售额",subtext:"厨师统计图",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",x:"left"},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["pie","funnel"],option:{funnel:{x:"25%",width:"50%",funnelAlign:"left",max:1548}}},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,series:[{name:"访问来源",type:"pie",radius:"55%",center:["50%","60%"]}]},i=echarts.init(document.getElementById("chart"));return function(){var f=JSON.parse(JSON.stringify(n.products)),o=f.slice(0,10),r=o.map(function(n){return{name:n.name,value:n.amount}}),e=f.slice(10),u;e.length>0&&(u=0,e.forEach(function(n){u+=n.amount}),r.push({name:"其他",value:u}));t.legend.data=r.map(function(n){return n.name});t.series[0].data=r;i.setOption(t)}}();$("#txtStartDate").datetimepicker(jdCat.utilData.dateOptions).on("changeDate",function(){n.start=this.value});$("#txtEndDate").datetimepicker(jdCat.utilData.dateOptions).on("changeDate",function(){n.end=this.value})})();